{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/Nikesh/Desktop/GuessWhere/guesswhere/node_modules/@babel/runtime/regenerator\";import _toConsumableArray from\"C:/Users/Nikesh/Desktop/GuessWhere/guesswhere/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _asyncToGenerator from\"C:/Users/Nikesh/Desktop/GuessWhere/guesswhere/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"C:/Users/Nikesh/Desktop/GuessWhere/guesswhere/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import{Button,Grid}from\"@material-ui/core\";import{GoogleMap,Marker,useLoadScript}from\"@react-google-maps/api\";import React,{useCallback,useContext,useEffect,useState}from\"react\";import Carousel from\"react-material-ui-carousel\";import{AuthContext}from\"../AuthProvider\";import firebase from\"../firebase\";import ChallengeResult from\"./ChallengeResult\";import SubChallengeResult from\"./SubChallengeResult\";import ParticlesBg from\"particles-bg\";var db=firebase.firestore();var mapContainerStyleNoMouse={position:\"absolute\",left:\"50%\",top:\"100%\",height:\"30vh\",width:\"25vw\",\"-ms-transform\":\"translate(-50%, -50%)\",transform:\"translate(-50%, -50%)\"};var mapContainerStyleMouse={position:\"absolute\",left:\"50%\",top:\"100%\",height:\"40vh\",width:\"100%\",\"-ms-transform\":\"translate(-50%, -50%)\",transform:\"translate(-50%, -50%)\"};var center={lat:39.693649,lng:-100.548059};var getRandomSubarray=function getRandomSubarray(arr,size){var shuffled=arr.slice(0),i=arr.length,temp,index;while(i--){index=Math.floor((i+1)*Math.random());temp=shuffled[index];shuffled[index]=shuffled[i];shuffled[i]=temp;}return shuffled.slice(0,size);};function RandomChallenge(props){var _useContext=useContext(AuthContext),currentUser=_useContext.currentUser;var _useState=useState(mapContainerStyleNoMouse),_useState2=_slicedToArray(_useState,2),mapstyle=_useState2[0],setMapStyle=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),subchallenges=_useState4[0],setSubchallenges=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),totalMarkers=_useState6[0],setTotalMarkers=_useState6[1];var _useState7=useState(0),_useState8=_slicedToArray(_useState7,2),totalPoints=_useState8[0],setTotalPoints=_useState8[1];var _useState9=useState(0),_useState10=_slicedToArray(_useState9,2),currentChallenge=_useState10[0],setCurrentChallenge=_useState10[1];var _useState11=useState(false),_useState12=_slicedToArray(_useState11,2),showResult=_useState12[0],setShowResult=_useState12[1];var _useState13=useState(null),_useState14=_slicedToArray(_useState13,2),marker=_useState14[0],setMarker=_useState14[1];var _useState15=useState(null),_useState16=_slicedToArray(_useState15,2),currentMarkers=_useState16[0],setCurrentMarkers=_useState16[1];var _useLoadScript=useLoadScript({googleMapsApiKey:process.env.REACT_APP_GOOGLE_MAPS_API_KEY}),isLoaded=_useLoadScript.isLoaded,loadError=_useLoadScript.loadError;var match=props.match;var params=match.params;var challengeId=params.challengeId;var getSubChallenges=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(subchallenges){var tempchallenges;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:tempchallenges=[];_context2.next=3;return Promise.all(subchallenges.map(/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(subchallenge){var challengedata;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return db.collection(\"Sub-challenges\").doc(subchallenge.id).get();case 2:challengedata=_context.sent;tempchallenges=[].concat(_toConsumableArray(tempchallenges),[challengedata.data()]);case 4:case\"end\":return _context.stop();}}},_callee);}));return function(_x2){return _ref2.apply(this,arguments);};}()));case 3:return _context2.abrupt(\"return\",tempchallenges);case 4:case\"end\":return _context2.stop();}}},_callee2);}));return function getSubChallenges(_x){return _ref.apply(this,arguments);};}();var handleGuess=function handleGuess(){console.log(subchallenges[currentChallenge].location);var actualMarker={lat:subchallenges[currentChallenge].location.latitude,lng:subchallenges[currentChallenge].location.longitude};var markersToSend={actual:actualMarker,guess:marker};setCurrentMarkers(markersToSend);setShowResult(true);};var handleMapClick=function handleMapClick(event){setMarker({lat:event.latLng.lat(),lng:event.latLng.lng()});};var handleMouseOver=function handleMouseOver(event){setMapStyle(mapContainerStyleMouse);};var handleMouseOut=function handleMouseOut(event){setMapStyle(mapContainerStyleNoMouse);};useEffect(function(){var fetchChallenge=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){var challengedata,subchallenges,tempchallenges;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return db.collection(\"Sub-challenges\").get();case 2:challengedata=_context3.sent;subchallenges=challengedata.docs;if(subchallenges.length>5){subchallenges=getRandomSubarray(subchallenges,5);}_context3.next=7;return getSubChallenges(subchallenges);case 7:tempchallenges=_context3.sent;console.log(tempchallenges[0]);setSubchallenges(tempchallenges);case 10:case\"end\":return _context3.stop();}}},_callee3);}));return function fetchChallenge(){return _ref3.apply(this,arguments);};}();fetchChallenge();},[]);var handleContinue=useCallback(function(points){console.log(\"updating\");console.log(points);setTotalPoints(function(currentPoints){return currentPoints+points;});setMarker(null);setTotalMarkers(function(total){return[].concat(_toConsumableArray(total),[currentMarkers]);});setCurrentMarkers(null);setCurrentChallenge(function(current){return current+1;});setShowResult(false);},[currentChallenge,currentMarkers]);if(loadError)return\"Error\";if(!isLoaded||subchallenges.length===0)return\"Loading...\";if(currentChallenge>=subchallenges.length){console.log(totalPoints);return/*#__PURE__*/_jsx(ChallengeResult,{totalPoints:totalPoints,totalMarkers:totalMarkers});}if(showResult){return/*#__PURE__*/_jsx(SubChallengeResult,{Markers:currentMarkers,onContinue:handleContinue});}return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{style:{position:\"fixed\",top:\"0\",left:\"0\",width:\"100%\",height:\"100%\",zIndex:\"-1\"},children:/*#__PURE__*/_jsx(ParticlesBg,{type:\"circle\",bg:true})}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"h1\",{style:{fontSize:\"40px\",textAlign:\"center\",color:\"black\"},children:\"Random Challenge!\"})}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(Grid,{container:true,direction:\"row\",alignItems:\"center\",justify:\"center\",spacing:0,children:[/*#__PURE__*/_jsx(Grid,{item:true,xs:\"auto\",sm:2,md:2,lg:2}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,sm:8,md:8,lg:8,children:/*#__PURE__*/_jsx(Carousel,{children:subchallenges[currentChallenge].images.map(function(item,i){return/*#__PURE__*/_jsx(\"img\",{style:{align:\"center\",display:\"block\",width:\"auto\",border:\"5px dotted black\",padding:\"20px\",marginLeft:\"auto\",marginRight:\"auto\"},src:item,alt:i,height:\"450\",width:\"700\",marginLeft:\"auto\",marginRight:\"auto\",class:\"center\"},i);})})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:\"auto\",sm:2,md:2,lg:2})]})}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(Button,{color:\"primary\",size:\"large\",variant:\"contained\",disabled:marker===null,onClick:handleGuess,style:{position:\"aboslute\",top:\"50%\",left:\"50%\",display:\"block\",align:\"center\",\"-ms-transform\":\"translate(-50%, -50%)\",transform:\"translate(-50%, -50%)\"},children:\"Guess\"})}),/*#__PURE__*/_jsx(\"div\",{onMouseOver:handleMouseOver,onMouseOut:handleMouseOut,children:/*#__PURE__*/_jsx(GoogleMap,{mapContainerStyle:mapstyle,zoom:3,center:center,onClick:handleMapClick,children:/*#__PURE__*/_jsx(Marker,{position:marker,icon:{url:\"/Images/guess.png\",origin:new window.google.maps.Point(0,0),anchor:new window.google.maps.Point(15,15),scaledSize:new window.google.maps.Size(30,30)},style:{align:\"center\",width:\"auto\",marginLeft:\"auto\",marginRight:\"auto\",position:\"fixed\",bottom:\"0\"}})})})]});}export default RandomChallenge;","map":{"version":3,"sources":["C:/Users/Nikesh/Desktop/GuessWhere/guesswhere/src/Components/RandomChallenge.js"],"names":["Button","Grid","GoogleMap","Marker","useLoadScript","React","useCallback","useContext","useEffect","useState","Carousel","AuthContext","firebase","ChallengeResult","SubChallengeResult","ParticlesBg","db","firestore","mapContainerStyleNoMouse","position","left","top","height","width","transform","mapContainerStyleMouse","center","lat","lng","getRandomSubarray","arr","size","shuffled","slice","i","length","temp","index","Math","floor","random","RandomChallenge","props","currentUser","mapstyle","setMapStyle","subchallenges","setSubchallenges","totalMarkers","setTotalMarkers","totalPoints","setTotalPoints","currentChallenge","setCurrentChallenge","showResult","setShowResult","marker","setMarker","currentMarkers","setCurrentMarkers","googleMapsApiKey","process","env","REACT_APP_GOOGLE_MAPS_API_KEY","isLoaded","loadError","match","params","challengeId","getSubChallenges","tempchallenges","Promise","all","map","subchallenge","collection","doc","id","get","challengedata","data","handleGuess","console","log","location","actualMarker","latitude","longitude","markersToSend","actual","guess","handleMapClick","event","latLng","handleMouseOver","handleMouseOut","fetchChallenge","docs","handleContinue","points","currentPoints","total","current","zIndex","fontSize","textAlign","color","images","item","align","display","border","padding","marginLeft","marginRight","url","origin","window","google","maps","Point","anchor","scaledSize","Size","bottom"],"mappings":"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","sourcesContent":["import { Button, Grid } from \"@material-ui/core\";\r\nimport { GoogleMap, Marker, useLoadScript } from \"@react-google-maps/api\";\r\nimport React, { useCallback, useContext, useEffect, useState } from \"react\";\r\nimport Carousel from \"react-material-ui-carousel\";\r\nimport { AuthContext } from \"../AuthProvider\";\r\nimport firebase from \"../firebase\";\r\nimport ChallengeResult from \"./ChallengeResult\";\r\nimport SubChallengeResult from \"./SubChallengeResult\";\r\nimport ParticlesBg  from \"particles-bg\";\r\n\r\nconst db = firebase.firestore();\r\n\r\nconst mapContainerStyleNoMouse = {\r\n  position: \"absolute\",\r\n  left: \"50%\",\r\n  top: \"100%\",\r\n  height: \"30vh\",\r\n  width: \"25vw\",\r\n  \"-ms-transform\": \"translate(-50%, -50%)\",\r\n  transform: \"translate(-50%, -50%)\",\r\n};\r\n\r\nconst mapContainerStyleMouse = {\r\n  position: \"absolute\",\r\n  left: \"50%\",\r\n  top: \"100%\",\r\n  height: \"40vh\",\r\n  width: \"100%\",\r\n  \"-ms-transform\": \"translate(-50%, -50%)\",\r\n  transform: \"translate(-50%, -50%)\",\r\n};\r\n\r\nconst center = {\r\n  lat: 39.693649,\r\n  lng: -100.548059,\r\n};\r\n\r\nconst getRandomSubarray = (arr, size) => {\r\n  var shuffled = arr.slice(0),\r\n    i = arr.length,\r\n    temp,\r\n    index;\r\n  while (i--) {\r\n    index = Math.floor((i + 1) * Math.random());\r\n    temp = shuffled[index];\r\n    shuffled[index] = shuffled[i];\r\n    shuffled[i] = temp;\r\n  }\r\n  return shuffled.slice(0, size);\r\n};\r\n\r\nfunction RandomChallenge(props) {\r\n  const { currentUser } = useContext(AuthContext);\r\n\r\n  const [mapstyle, setMapStyle] = useState(mapContainerStyleNoMouse);\r\n  const [subchallenges, setSubchallenges] = useState([]);\r\n  const [totalMarkers, setTotalMarkers] = useState([]);\r\n  const [totalPoints, setTotalPoints] = useState(0);\r\n  const [currentChallenge, setCurrentChallenge] = useState(0);\r\n\r\n  const [showResult, setShowResult] = useState(false);\r\n  const [marker, setMarker] = useState(null);\r\n  const [currentMarkers, setCurrentMarkers] = useState(null);\r\n\r\n  const { isLoaded, loadError } = useLoadScript({\r\n    googleMapsApiKey: process.env.REACT_APP_GOOGLE_MAPS_API_KEY,\r\n  });\r\n\r\n  const { match } = props;\r\n  const { params } = match;\r\n  const { challengeId } = params;\r\n\r\n  const getSubChallenges = async (subchallenges) => {\r\n    var tempchallenges = [];\r\n    await Promise.all(\r\n      subchallenges.map(async (subchallenge) => {\r\n        const challengedata = await db\r\n          .collection(\"Sub-challenges\")\r\n          .doc(subchallenge.id)\r\n          .get();\r\n        tempchallenges = [...tempchallenges, challengedata.data()];\r\n      })\r\n    );\r\n    return tempchallenges;\r\n  };\r\n\r\n  const handleGuess = () => {\r\n    console.log(subchallenges[currentChallenge].location);\r\n    const actualMarker = {\r\n      lat: subchallenges[currentChallenge].location.latitude,\r\n      lng: subchallenges[currentChallenge].location.longitude,\r\n    };\r\n    const markersToSend = {\r\n      actual: actualMarker,\r\n      guess: marker,\r\n    };\r\n    setCurrentMarkers(markersToSend);\r\n    setShowResult(true);\r\n  };\r\n\r\n  const handleMapClick = (event) => {\r\n    setMarker({\r\n      lat: event.latLng.lat(),\r\n      lng: event.latLng.lng(),\r\n    });\r\n  };\r\n\r\n  const handleMouseOver = (event) => {\r\n    setMapStyle(mapContainerStyleMouse);\r\n  };\r\n\r\n  const handleMouseOut = (event) => {\r\n    setMapStyle(mapContainerStyleNoMouse);\r\n  };\r\n\r\n  useEffect(() => {\r\n    const fetchChallenge = async () => {\r\n      const challengedata = await db.collection(\"Sub-challenges\").get();\r\n      var subchallenges = challengedata.docs;\r\n      if (subchallenges.length > 5) {\r\n        subchallenges = getRandomSubarray(subchallenges, 5);\r\n      }\r\n      const tempchallenges = await getSubChallenges(subchallenges);\r\n      console.log(tempchallenges[0]);\r\n      setSubchallenges(tempchallenges);\r\n    };\r\n    fetchChallenge();\r\n  }, []);\r\n\r\n  const handleContinue = useCallback(\r\n    (points) => {\r\n      console.log(\"updating\");\r\n      console.log(points);\r\n      setTotalPoints((currentPoints) => currentPoints + points);\r\n      setMarker(null);\r\n      setTotalMarkers((total) => [...total, currentMarkers]);\r\n      setCurrentMarkers(null);\r\n      setCurrentChallenge((current) => current + 1);\r\n      setShowResult(false);\r\n    },\r\n    [currentChallenge, currentMarkers]\r\n  );\r\n\r\n  if (loadError) return \"Error\";\r\n  if (!isLoaded || subchallenges.length === 0) return \"Loading...\";\r\n  if (currentChallenge >= subchallenges.length) {\r\n    console.log(totalPoints);\r\n    return (\r\n      <ChallengeResult totalPoints={totalPoints} totalMarkers={totalMarkers} />\r\n    );\r\n  }\r\n  if (showResult) {\r\n    return (\r\n      <SubChallengeResult\r\n        Markers={currentMarkers}\r\n        onContinue={handleContinue}\r\n      />\r\n    );\r\n  }\r\n  return (\r\n    <div>\r\n      <div\r\n      \r\n      style={{\r\n        position: \"fixed\", \r\n        top:\"0\", \r\n        left:\"0\", \r\n        width:\"100%\", \r\n        height:\"100%\",\r\n        zIndex: \"-1\"\r\n      }}\r\n      >\r\n        <ParticlesBg type=\"circle\" bg={true} />\r\n      </div>\r\n        <div>\r\n        <h1 style={{fontSize: \"40px\", textAlign: \"center\", color:\"black\"}} >Random Challenge!</h1>\r\n      </div>\r\n\r\n      <div>\r\n      <Grid\r\n        container\r\n        direction=\"row\"\r\n        alignItems=\"center\"\r\n        justify=\"center\"\r\n        spacing={0}\r\n      >\r\n        <Grid item xs={\"auto\"} sm={2} md={2} lg={2} />\r\n        <Grid item xs={12} sm={8} md={8} lg={8}>\r\n          <Carousel>\r\n            {subchallenges[currentChallenge].images.map((item, i) => (\r\n              <img \r\n              style={{\r\n                align: \"center\",\r\n                display:\"block\",\r\n                width: \"auto\",\r\n                border: \"5px dotted black\",\r\n                padding: \"20px\",\r\n                marginLeft: \"auto\",\r\n                marginRight: \"auto\"\r\n              }}\r\n              src={item} alt={i} key={i} height={\"450\"} width={\"700\"} marginLeft= {\"auto\"}\r\n              marginRight= {\"auto\"} class={\"center\"} />\r\n            ))}\r\n          </Carousel>\r\n        </Grid>\r\n        <Grid item xs={\"auto\"} sm={2} md={2} lg={2} />\r\n      </Grid>\r\n      </div>\r\n\r\n      <div>\r\n      <Button\r\n            color=\"primary\"\r\n            size=\"large\"\r\n            variant=\"contained\"\r\n            disabled={marker === null}\r\n            onClick={handleGuess}\r\n\r\n            style={{\r\n              position: \"aboslute\", \r\n              top: \"50%\",\r\n              left: \"50%\",\r\n              display:\"block\",\r\n              align:\"center\",\r\n              \"-ms-transform\": \"translate(-50%, -50%)\",\r\n              transform: \"translate(-50%, -50%)\",\r\n            \r\n            }}\r\n          >\r\n            Guess\r\n          </Button>\r\n      </div>\r\n      <div onMouseOver={handleMouseOver} onMouseOut={handleMouseOut}>\r\n        <GoogleMap\r\n          mapContainerStyle={mapstyle}\r\n          zoom={3}\r\n          center={center}\r\n          onClick={handleMapClick}\r\n        >\r\n          <Marker\r\n            position={marker}\r\n            icon={{\r\n              url: `/Images/guess.png`,\r\n              origin: new window.google.maps.Point(0, 0),\r\n              anchor: new window.google.maps.Point(15, 15),\r\n              scaledSize: new window.google.maps.Size(30, 30),\r\n            }}\r\n\r\n            style={{\r\n              align: \"center\",\r\n              width: \"auto\",\r\n              marginLeft: \"auto\",\r\n              marginRight: \"auto\",\r\n\r\n              position: \"fixed\", \r\n              bottom:\"0\",\r\n            }}\r\n          />\r\n        </GoogleMap>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default RandomChallenge;"]},"metadata":{},"sourceType":"module"}